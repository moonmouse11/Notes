# Basics
***
## General
**Реляционная база данных** - это упорядоченная информация, связанная между собой определенными отношениями.
***
1. DDL - (Data Definition Language) работают с целыми таблицами. `CREATE` `ALTER` `DROP`
2. DML - (Data Manipulation Language) операторы для работы с содержимым таблицы. `SELECT` `INSERT` `UPDATE` `DELETE`  
3. DCL - (Data Control Language) определение доступа к данным. `GRANT` `REVOKE` `DENY` 
4. TCL - (Transactional Control Language) управление тразакциями. `BEGIN TRANSACTION` `COMMIT TRANSACTION` `ROLLBACK TRANSACTION` `SAVE TRANSACTION` 
***
## ACID
**ACID** - это аббревиатура, обозначающая четыре основных характеристики транзакций в базах данных: атомарность (Atomicity), согласованность (Consistency), изолированность (Isolation) и долговечность (Durability).
ACID-свойства являются важными для обеспечения надежности и целостности данных в системе, особенно в контексте критически важных приложений, где требуется консистентность данных.
- A - `Atomicity`. Атомарность - гарантирует, что каждая транзакция будет выполнена полностью, или не будет выполнена совсем, без промежуточных состояний. Транзакция считается атомарной, если она выполняется как единое целое, и либо все ее операции будут успешно выполнены, либо ни одна.
- C - `Consistency`. Согласованность - транзакция, достигающая своего нормального завершения и, тем самым, фиксирующая свои результаты, сохраняет согласованность базы данных. Каждая успешная транзакция по определению фиксирует только допустимые результаты. Согласованность гарантирует, что после успешного завершения транзакции база данных находится в согласованном состоянии. Это означает, что интегритет данных должен быть сохранен, а все ограничения и правила, определенные на уровне базы данных, должны быть соблюдены.
- I - `Isolation`. Изолированность - во время выполнения транзакции параллельные транзакции не должны оказывать влияние не ее результат. Изолированность обеспечивает, что каждая транзакция выполняется в изолированной среде, рассматривающей ее как единственную выполняющуюся транзакцию. Это гарантирует, что результаты одной транзакции не будут видны другим транзакциям, пока они не будут успешно завершены.
- D -`Durability`. Устойчивость - если пользователь получил от системы, что транзакция выполнена, он может быть уверен, что изменения не будут отменены. Долговечность означает, что после успешного завершения транзакции, ее изменения должны оставаться постоянными и не должны быть потеряны из-за сбоев в системе или других внешних факторов.
Набор требований считается фактическим стандартом для высоконадёжных систем, прежде всего, [реляционных СУБД](https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%BB%D1%8F%D1%86%D0%B8%D0%BE%D0%BD%D0%BD%D0%B0%D1%8F_%D0%A1%D0%A3%D0%91%D0%94 "Реляционная СУБД"), при этом с середины 2000-х годов для построения распределённых СУБД предполагается отказ от части требований ACID (для обоснования чего используются [теорема CAP](https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D0%BE%D1%80%D0%B5%D0%BC%D0%B0_CAP "Теорема CAP"), [теорема PACELC](https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D0%BE%D1%80%D0%B5%D0%BC%D0%B0_PACELC "Теорема PACELC")) или снижение строгости требований ([BASE](https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D0%BE%D1%80%D0%B5%D0%BC%D0%B0_CAP#BASE-%D0%B0%D1%80%D1%85%D0%B8%D1%82%D0%B5%D0%BA%D1%82%D1%83%D1%80%D0%B0 "Теорема CAP")).
***
## CRUD
- C - Create.
- R - Read.
- U - Update.
- D - Delete.
***
## Частые проблемы и способы оптимизации MySQL
Путь к конфигу Linux `/etc/mysql/my.cnf`
1. Настройка буфера. `innodb_buffer_pool_size`
2. Проверка размера логов. `innodb_log_file_size` `innodb_flush_log_at_trx_commit` `innodb_flush_method` 
3. Настройка индексов. 
	1. Уникальные-первичные индексы
	2. Регулярные индексы
	3. Полнотекстовые индексы
	4. Обратные индексы
***
## Нормальные формы баз данных
**Нормализация** - это метод проектирования базы данных, который позволяет привести БД к минимальной избыточности.
#### Нормализация нужна для:
- Устранения аномалий.
- Повышения производительности.
- Повышения удобства управления данными.
Процесс нормализации - это последовательный процесс приведения базы данных к эталонному виду. (Переход от одной нормальной формы к следующей).
#### Полный порядок нормальных форм:
1. Ненормальная форма или нулевая нормальная форма. (UNF).
2. Первая нормальная форма. (1NF).
3. Вторая нормальная форма. (2NF).
4. Третья нормальная форма. (3NF).
5. Нормальная форма Бойса-Кодда. (BCNF).
6. Четверая нормальная форма. (4NF).
7. Пятая нормальная форма. (5NF).
8. Доменно-ключевая нормальная форма. (DKNF).
9. Шестая нормальная форма. (6NF).

### 1. UNF
Перед приведением БД к нормальной форме, нужно привести ее к табличному виду так, чтобы он отвечал базовым принципам реляционной теории.
Строки в таблицах не должны быть пронумерованы (порядок строк и столбцов не имеет значения).
### 2. 1NF
	1. В таблице не должно быть дублирующих строк.
	2. В каждой ячейке таблицы хранится атомарное значение (одно несоставное значение).
	3. В столбце хранятся данные одного типа.
	4. Отсутствуют массивыи списки в любом виде.
### 3. 2NF
	1. Таблица должна находится в 1NF.
	2. Таблицы должна иметь ключ
	3. Все неключевые столбцы таблицы должны зависеть от полного ключа (в случае, если ключ составной)
**Ключ** - это столбец, или набор столбцов, по которым гарантировано можно отличить строки друг от друга. Ключ идентифицирует каждую строку таблицы. По ключу мы можем обратиться к конкретной строке данных в таблице.
Если ключ состоит из нескольких столбцов, то все остальные неключевые столбцы должны зависеть от всего ключа.
В таблице не должно быть данных, которые можно получить зная только половину ключа.
***Таблица должна иметь правильный ключ, по которому можно идентифицировать каждую строку***
**Декомпозиция** - это процесс разбиения одного отношения (таблицы) на несколько.
### 4. 3NF
	1. Таблица должнв находиться в 2NF.
	2. В таблицах должна отсутствовать транзитивная зависимость.
**Транзитивная зависимость** - это когда неключевые столбцы зависят от значений других неключевых столбцов.
Неключевые столбцы не должны пытаться играть роль ключа в таблице.
***Таблица должна содержать правильные неключевые столбцы***
### 5. BCNF
	1. Таблица должна находиться в 3NF.
	2. Ключевые атрибуты составного ключа не должны зависеть от неключевых атрибутов.
***Требования BCNF актуальны только для таблиц с составными ключами.***
***Часть составного первичного ключа не должна зависеть от неключевого столбца.***
### 6. 4NF
***В таблицах должны отсутствовать нетривиальные многозначные зависимости***
### 7. 5NF
***(Проекционно-соеденительная форма) - каждая нетривиальная зависимость соединения в ней определяется потенциальным ключом (ключами) этого отношения.***
**Декомпозиция без потерь** - процесс разбиения одной таблицы на несколько, при условии, что в случае соединения таблиц, которые были получены в результате декомпозиции, будет формироваться та же информация, что и в исходной таблице до декомпозиции.
### 8. DKNF
**Ограничение домена**  - это ограничение, предпысывающее использование для определенного атрибута значений только изнекоторого заданного домена (набора значений).
**Ограничение ключа** - это ограничение, утверждающее, что некоторый атрибут или комбинация атрибутов представляет собой потенциальный ключ.
Каждое наложенное ограничение на таблицу должно являться логическим следствием ограничений доменов и ограничений ключей, которые накладываются на данную таблицу.
### 9. 6NF
**Хронологическая БД** - это база, которая может хранить не только текущие денные, но и исторические данные, относящиеся к прошлым периодам времени. Однако такая база может хранить и данные, относящиеся к будущим периодам времени.
***Таблица должна удовлетворять всем нетривиальны зависимостям соединения.***
Таблица находится в 6NF, когда она неприводима, то есть не может быть подвергнута дальнейшей декомпозиции без потерь.
__`Шестая нормальная форма вводит такое понятие как "Декомпозиция до конца" - максимально возможная декомпозиция таблиц.`__
***
## Модель данных (ERD)
**Модель данных** - это концептуальное представление для выражения и передачи бизнес-требований. Оно наглядно показывает характер данных, бизнес-правила, управляющие данными, и то, как они будут организованы в БД.
#### Сущности и атрибуты:
1. **Сущности** - это "вещи" в бизнес-среде, о которых мы хотим хранить иформацию в БД.
2. **Атрибуты** - используются для организации и структурирования данных.
			Сущности -> таблицы.
			Атрибуты -> колонки.
3. **Взаимосвязь** - описывает, как одна сущность связана с другой.
	- **Один к одному**
	- **Многие к одному**
	- **Многие ко многим**
4. **Сущность пересечения** - ее можно использовать, если между сущностями есть связь "многие ко многим", что бы декомпозировать эту свзять и привести ее к типу "один ко многим" или "многие к одному".
**ERD** - (Entity Relationship Diagram) Показывает сущности и отношения между ними. Они может принимать форму концептуальной, логиической или физической модели данных.
1. Сбор бизнес-требований.
2. Выделение сущностей.
3. Постреоние концептуальной/логической моделей.
4. Построение физической модели.
5. Создание БД.
***
# Индексация
**Индексация** - это что-то вроде книжного содержания: не нужно перелистывать все страницы книги, что бы найти нужную главу, а можно просто найти нужную страницу в содержании.
***Индексация позволяет с помощью индекса быстрее найти в БД данные по запросу***
`CREATE INDEX` 
**Двоичный поиск** - повторяющееся деление данных пополам и определение того, находится ли нужная запись до или послезаписи в середине структуры данных. Если значение нужной записи меньше срединного, то поиск продолжается в первой половине и наоборот. Процедура повторяется, пока не найдется нужное значение.
**Некластеризованный индекс** - нужен, чтобы применить индексы к неключевым столбцам - такие индексы требуют явного определения.
Некластеризованный индекс хранится в одном месте, а физические данные таблицы - в другом.
~~Не использовать~~
1. Не использовать в небольших талицах.
2. Не использовать в таблицах с частыми массовыми `UPDATE` и `INSERT`.
3. Не использовать, где есть `NULL`
4. Не использовать для столбцов с частой обработкой.
***
## Шардинг и репликация
**Репликация** - позволяет создать полный дубликат БД. Так, вместо одного сервера у вас их будет несколько.
Репликация позволяет разгрузить основной сервер за счет переноса операций чтения на слейв.
**Шардинг** - суть шардинга в разделени (партиционировании) базы данных на отдельные части так, что каждую из них можно было вынесли на отдельный сервер - так мы распределяем нагрузку.
- **Вертикальный шардинг** - это выделение таблицы или группы таблиц на отдельный сервер.
- **Горизонтальный шардинг** - это разделение одной таблицы на разные сервера. Используется для очень больших таблиц.
***
## Персистентность
_**Персистентные структуры данных**_ (англ. _persistent data structure_) — это структуры данных, которые при внесении в них каких-то изменений сохраняют все свои предыдущие состояния и доступ к этим состояниям.
Есть несколько уровней персистентности:
- **частичная** (англ. _partial_),
- **полная** (англ. _full_),
- **конфлюэнтная** (англ. _confluent_),
- **функциональная** (англ. _functional_).
Есть несколько способов сделать любую структуру персистентной:
- **полное копирование** (англ. _full copy_) когда при любой операции изменения полностью копируется структура данных и в получившуюся новую копию вносятся изменения,
- **копирование пути** (англ. _path copying_),
- **метод «толстых» узлов** (англ. _fat node_).